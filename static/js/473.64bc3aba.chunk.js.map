{"version":3,"file":"static/js/473.64bc3aba.chunk.js","mappings":"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","sources":["components/Loader.tsx","components/BlueButton.tsx","hooks/useFetchHistoricalPrices.ts","resources/errorDictionary.ts","hooks/useTypedSelector.ts","pages/ResultsPage/ResultsPage.tsx"],"sourcesContent":["import { memo } from \"react\";\r\n\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Progress from \"@material-ui/core/CircularProgress\";\r\n\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\n\r\nconst Container = withStyles({\r\n  root: {\r\n    margin: \"0 auto\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    height: \"100vh\",\r\n    alignItems: \"center\",\r\n    background: \"transparent\",\r\n    paddingTop: \"10vh\",\r\n  },\r\n})(Box);\r\n\r\nconst ContainerVerticallyCentered = withStyles({\r\n  root: {\r\n    justifyContent: \"center\",\r\n  },\r\n})(Container);\r\n\r\nexport const CircularProgress = withStyles({\r\n  root: {\r\n    color: \"rgba(122, 194, 33, 0.8);\",\r\n  },\r\n})(Progress);\r\n/**\r\n * creates memoised spinner that indicates loading state\r\n * @returns spinner component\r\n */\r\nconst Loader = memo(() => {\r\n  return (\r\n    <ContainerVerticallyCentered>\r\n      <CircularProgress thickness={5} size={100} />\r\n    </ContainerVerticallyCentered>\r\n  );\r\n});\r\n\r\nexport default Loader;\r\n","import \"./_button.scss\";\r\n\r\ninterface Props {\r\n  classes?: string;\r\n  isEnabled?: boolean;\r\n  clickHandler?: React.MouseEventHandler<HTMLButtonElement> | undefined;\r\n  label?: string;\r\n}\r\n\r\nconst BlueButton = (props: Props) => {\r\n  const { classes = \"enabled\", isEnabled = true, clickHandler = () => {}, label = \"\" } = props;\r\n  const baseClassName = \"BlueButton\";\r\n\r\n  return (\r\n    <button className={`${baseClassName} ${classes}`} onClick={clickHandler} disabled={!isEnabled}>\r\n      {label}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default BlueButton;\r\n","import axios from \"axios\";\r\n\r\nimport { useState, useCallback } from \"react\";\r\nimport { useSnackbar } from \"notistack\";\r\n\r\nimport { BaseCurrency, CurrencyCrypto, HistoricalPrices, NotAvailable } from \"types\";\r\nimport { CreateURL } from \"functions\";\r\n\r\nconst useFetchHistoricalPrices = () => {\r\n  const [data, setData] = useState<HistoricalPrices | null>(null);\r\n  const [error, setError] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const { enqueueSnackbar } = useSnackbar();\r\n\r\n  let historicalPrices: HistoricalPrices = [];\r\n\r\n  const fatalError = useCallback(() => {\r\n    setError(true);\r\n    enqueueSnackbar(`No data fetched at all for given endpoints`, {\r\n      variant: \"error\",\r\n    });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const theEndOfRecursiveFetchLoopHandle = () => {\r\n    setLoading(false);\r\n\r\n    if (historicalPrices.length) {\r\n      setData(historicalPrices);\r\n    } else {\r\n      fatalError();\r\n    }\r\n  };\r\n\r\n  const fetchData = async (endpoints: string[], baseCurrency: BaseCurrency) => {\r\n    if (endpoints.length) {\r\n      let URL = endpoints.shift();\r\n      let reducedEndpoints = [...endpoints]; /// co ta linika robi, tylko kopię tworzy?\r\n\r\n      axios\r\n        .get(URL as string, { Apikey: process.env.REACT_APP_API_KEY as string })\r\n        .then(data => {\r\n          const weatherData = { ...data };\r\n          if (data.hasOwnProperty(\"data\")) {\r\n            if (weatherData.data.hasOwnProperty(baseCurrency)) {\r\n              historicalPrices.push(weatherData.data[baseCurrency]);\r\n            } else {\r\n              historicalPrices.push(NotAvailable.na); // todo coś za czesto wychodzi n/a sprawdzić\r\n            }\r\n\r\n            if (reducedEndpoints.length) {\r\n              fetchData(reducedEndpoints, baseCurrency);\r\n            } else {\r\n              theEndOfRecursiveFetchLoopHandle();\r\n            }\r\n          } else {\r\n            setLoading(false);\r\n            const label = URL ? URL : \"unknown location\";\r\n            enqueueSnackbar(`Data for ${label} was broken, corrupted or otherwise invalid`, {\r\n              variant: \"warning\",\r\n            });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          let code = err.response ? err.response.status : err;\r\n          enqueueSnackbar(`Error ${code} encountered when fetching data for ${URL}`, {\r\n            variant: \"warning\",\r\n          });\r\n          if (reducedEndpoints.length) {\r\n            fetchData(reducedEndpoints, baseCurrency);\r\n          } else {\r\n            theEndOfRecursiveFetchLoopHandle();\r\n          }\r\n        });\r\n    } else {\r\n      setError(true);\r\n      enqueueSnackbar(`Empty array of URLs passed to useAxiosArray as argument`, {\r\n        variant: \"error\",\r\n      });\r\n    }\r\n  };\r\n  const fetchHistoricalPrices = (currencyCrypto: CurrencyCrypto, baseCurrency: BaseCurrency) => {\r\n    fetchData(CreateURL.historical(currencyCrypto, baseCurrency), baseCurrency);\r\n  };\r\n\r\n  return { data, error, loading, fetchHistoricalPrices };\r\n};\r\n\r\nexport default useFetchHistoricalPrices;\r\n\r\n/**\r\n * todo weather co tu robi?\r\n */\r\n","/**\r\n * Not in use. perhaps in the future\r\n */\r\n\r\nlet errorDictionary: { [key: string]: string } = {\r\n  404: \"Not found\",\r\n};\r\n\r\nerrorDictionary = new Proxy(errorDictionary, {\r\n  get(target, phrase: string) {\r\n    if (phrase in target) {\r\n      return target[phrase];\r\n    } else {\r\n      return phrase;\r\n    }\r\n  },\r\n});\r\n\r\nexport default errorDictionary;\r\n","import { useSelector, TypedUseSelectorHook } from 'react-redux';\r\nimport { RootStateType } from '../components/AppProvider';\r\n/**\r\n * prepares useSelectorHook which knows RootStateType\r\n */\r\nexport const useTypedSelector: TypedUseSelectorHook<RootStateType> = useSelector;\r\n","import * as React from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useQuery } from \"react-query\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { useFetchHistoricalPrices } from \"hooks\";\r\nimport { BlueButton } from \"components\";\r\nimport { CreateURL, hasDateChanged, createResults } from \"functions\";\r\nimport { ResultsType, HistoricalPrices, CryptoPrice } from \"types\";\r\nimport { initialIntervalMs } from \"../../config\";\r\nimport { SelectedCurrenciesContext } from \"contexts/currenciesContext\";\r\n\r\nconst ResultsTable = React.lazy(() => import(\"./parts/ResultsTable\"));\r\nconst FetchStatusIndicator = React.lazy(() => import(\"./parts/FetchStatusIndicator\"));\r\n\r\n/**\r\n * Presents cryptocurrency price current and historical\r\n * @returns component\r\n */\r\nconst ResultsPage = (): JSX.Element => {\r\n  const history = useHistory();\r\n  const { enqueueSnackbar } = useSnackbar();\r\n  const { currencyBase, currencyCrypto } = React.useContext(SelectedCurrenciesContext); // tu przemianować na selectedBaseCurrency i selectedCryptoCurrency\r\n  const intervalMs = initialIntervalMs;\r\n  const currentURL = CreateURL.current(currencyCrypto.value, currencyBase);\r\n  const [results, setResults] = React.useState<ResultsType | null>(null);\r\n  const [historicalCryptoPrice, sethistoricalCryptoPrice] = React.useState<HistoricalPrices | undefined | null>(undefined); // todo czy ten stan jest na pewno potrzebny\r\n\r\n  const { data: fetchedCryptocurrencyPrice, error } = useQuery(\r\n    \"currentCrypto\",\r\n    async () => {\r\n      if (hasDateChanged(intervalMs)) {\r\n        fetchHistoricalPrices(currencyCrypto, currencyBase);\r\n      }\r\n      const result = await axios.get(currentURL, { Apikey: process.env.REACT_APP_API_KEY });\r\n\r\n      return result.data;\r\n    },\r\n    {\r\n      refetchInterval: intervalMs,\r\n    }\r\n  );\r\n\r\n  const { data: fetchedHistoricalPrices, fetchHistoricalPrices } = useFetchHistoricalPrices();\r\n\r\n  const returnToSelectionPage = React.useCallback(() => {\r\n    history.push(\"/\");\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    fetchHistoricalPrices(currencyCrypto, currencyBase);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    if (fetchedCryptocurrencyPrice && historicalCryptoPrice) {\r\n      let cryptoPrice = fetchedCryptocurrencyPrice[currencyBase] as CryptoPrice;\r\n      typeof cryptoPrice === \"number\" &&\r\n        enqueueSnackbar(`Zmiana`, {\r\n          variant: \"success\",\r\n        });\r\n\r\n      typeof cryptoPrice === \"string\" &&\r\n        enqueueSnackbar(`Na serwerze nie ma danych o bieżącym kursie kryptowaluty`, {\r\n          variant: \"info\",\r\n        });\r\n\r\n      const result = createResults({ cryptoPrice, historicalCryptoPrice, currencyBase });\r\n      setResults(result);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [fetchedCryptocurrencyPrice, historicalCryptoPrice]);\r\n\r\n  React.useEffect(() => {\r\n    if (fetchedHistoricalPrices && historicalCryptoPrice !== fetchedHistoricalPrices) {\r\n      sethistoricalCryptoPrice(fetchedHistoricalPrices);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [fetchedHistoricalPrices]);\r\n\r\n  return (\r\n    <>\r\n      {(error || !results) && (\r\n        <React.Suspense fallback={null}>\r\n          <FetchStatusIndicator crypto={currencyCrypto.label} result={Boolean(results)} error={error} />\r\n        </React.Suspense>\r\n      )}\r\n      <BlueButton label=\"Powrót do wyboru\" clickHandler={returnToSelectionPage} />\r\n      {results && (\r\n        <React.Suspense fallback={null}>\r\n          <ResultsTable currencyCrypto={currencyCrypto} results={results} />\r\n        </React.Suspense>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ResultsPage;\r\n\r\n/**\r\n * todo wydzielić media query do osobnego pliku i wczytywać ten plik warunkowo. Ale, co sie stanie kiedy zrobimy resize?\r\n * todo doczytać o concurrent axios\r\n * todo prawdopodobnie niepotrzebna animka na bluebutton, z szarego na chwilę znika.\r\n *\r\n */\r\n"],"names":["Container","withStyles","root","margin","display","flexDirection","height","alignItems","background","paddingTop","Box","ContainerVerticallyCentered","justifyContent","CircularProgress","color","Progress","Loader","memo","thickness","size","props","classes","isEnabled","clickHandler","label","className","onClick","disabled","useState","data","setData","error","setError","loading","setLoading","enqueueSnackbar","useSnackbar","historicalPrices","fatalError","useCallback","variant","theEndOfRecursiveFetchLoopHandle","length","fetchData","endpoints","baseCurrency","URL","shift","reducedEndpoints","axios","Apikey","process","then","weatherData","hasOwnProperty","push","NotAvailable","catch","err","code","response","status","fetchHistoricalPrices","currencyCrypto","CreateURL","errorDictionary","Proxy","get","target","phrase","useTypedSelector","useSelector","ResultsTable","React","FetchStatusIndicator","history","useHistory","SelectedCurrenciesContext","currencyBase","intervalMs","initialIntervalMs","currentURL","value","results","setResults","undefined","historicalCryptoPrice","sethistoricalCryptoPrice","useQuery","hasDateChanged","result","refetchInterval","fetchedCryptocurrencyPrice","useFetchHistoricalPrices","fetchedHistoricalPrices","returnToSelectionPage","cryptoPrice","createResults","fallback","crypto","Boolean"],"sourceRoot":""}